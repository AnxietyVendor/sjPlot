<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot polynomials for (generalized) linear regression — sjp.poly • sjPlot</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Plot polynomials for (generalized) linear regression — sjp.poly" />

<meta property="og:description" content="This function plots a scatter plot of a term poly.term
               against a response variable x and adds - depending on
               the amount of numeric values in poly.degree - multiple
               polynomial curves. A loess-smoothed line can be added to see
               which of the polynomial curves fits best to the data." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sjPlot</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/blackwhitefigures.html">Black &amp; White Figures for Print Journals</a>
    </li>
    <li>
      <a href="../articles/custplot.html">Customize Plot Appearance</a>
    </li>
    <li>
      <a href="../articles/plot_interactions.html">Plotting Interaction Effects of Regression Models</a>
    </li>
    <li>
      <a href="../articles/plot_marginal_effects.html">Plotting Marginal Effects of Regression Models</a>
    </li>
    <li>
      <a href="../articles/plot_model_estimates.html">Plotting Estimates (Fixed Effects) of Regression Models</a>
    </li>
    <li>
      <a href="../articles/sjtitemanalysis.html">Item Analysis of a Scale or an Index</a>
    </li>
    <li>
      <a href="../articles/table_css.html">Customizing HTML tables</a>
    </li>
    <li>
      <a href="../articles/tab_bayes.html">Summary of Baysian Models as HTML Table</a>
    </li>
    <li>
      <a href="../articles/tab_mixed.html">Summary of Mixed Models as HTML Table</a>
    </li>
    <li>
      <a href="../articles/tab_model_estimates.html">Summary of Regression Models as HTML Table</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/strengejacke/sjPlot">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot polynomials for (generalized) linear regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/strengejacke/sjPlot/blob/master/R/sjPlotPolynomials.R'><code>R/sjPlotPolynomials.R</code></a></small>
    <div class="hidden name"><code>sjp.poly.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function plots a scatter plot of a term <code>poly.term</code>
               against a response variable <code>x</code> and adds - depending on
               the amount of numeric values in <code>poly.degree</code> - multiple
               polynomial curves. A loess-smoothed line can be added to see
               which of the polynomial curves fits best to the data.</p>
    
    </div>

    <pre class="usage"><span class='fu'>sjp.poly</span>(<span class='no'>x</span>, <span class='no'>poly.term</span>, <span class='no'>poly.degree</span>, <span class='kw'>poly.scale</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>axis.title</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>geom.colors</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>geom.size</span> <span class='kw'>=</span> <span class='fl'>0.8</span>,
  <span class='kw'>show.loess</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>show.loess.ci</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>show.p</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>show.scatter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>point.alpha</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>point.color</span> <span class='kw'>=</span> <span class='st'>"#404040"</span>,
  <span class='kw'>loess.color</span> <span class='kw'>=</span> <span class='st'>"#808080"</span>, <span class='kw'>prnt.plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A vector, representing the response variable of a linear (mixed) model; or
a linear (mixed) model as returned by <code>lm</code> or <code><a href='http://www.rdocumentation.org/packages/lme4/topics/lmer'>lmer</a></code>.</p></td>
    </tr>
    <tr>
      <th>poly.term</th>
      <td><p>If <code>x</code> is a vector, <code>poly.term</code> should also be a vector, representing
the polynomial term (independent variabl) in the model; if <code>x</code> is a
fitted model, <code>poly.term</code> should be the polynomial term's name as character string.
See 'Examples'.</p></td>
    </tr>
    <tr>
      <th>poly.degree</th>
      <td><p>Numeric, or numeric vector, indicating the degree of the polynomial.
If <code>poly.degree</code> is a numeric vector, multiple polynomial curves for
each degree are plotted. See 'Examples'.</p></td>
    </tr>
    <tr>
      <th>poly.scale</th>
      <td><p>Logical, if <code>TRUE</code>, <code>poly.term</code> will be scaled before
linear regression is computed. Default is <code>FALSE</code>. Scaling the polynomial
term may have an impact on the resulting p-values.</p></td>
    </tr>
    <tr>
      <th>fun</th>
      <td><p>Linear function when modelling polynomial terms. Use <code>fun = "lm"</code>
for linear models, or <code>fun = "glm"</code> for generalized linear models.
When <code>x</code> is not a vector, but a fitted model object, the function
is detected automatically. If <code>x</code> is a vector, <code>fun</code> defaults
to <code>"lm"</code>.</p></td>
    </tr>
    <tr>
      <th>axis.title</th>
      <td><p>Character vector of length one or two (depending on
the plot function and type), used as title(s) for the x and y axis.
If not specified, a default labelling  is chosen. To set multiple
axis titles (e.g. with <code>type = "eff"</code> for many predictors),
<code>axis.title</code> must be a character vector of same length of plots
that are printed. In this case, each plot gets an own axis title
(applying, for instance, to the y-axis for <code>type = "eff"</code>).
<strong>Note:</strong> Some plot types do not support this argument. In such
cases, use the return value and add axis titles manually with
<code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/labs'>labs</a></code>, e.g.: <code>$plot.list[[1]] + labs(x = ...)</code></p></td>
    </tr>
    <tr>
      <th>geom.colors</th>
      <td><p>User defined color palette for geoms. If <code>group.estimates</code>
is <em>not</em> specified, must either be vector with two color values or a specific
color palette code (see 'Details' in <code><a href='sjp.grpfrq.html'>sjp.grpfrq</a></code>). Else, if
<code>group.estimates</code> is specified, <code>geom.colors</code> must be a vector
of same length as groups. See 'Examples'.</p></td>
    </tr>
    <tr>
      <th>geom.size</th>
      <td><p>size resp. width of the geoms (bar width, line thickness or point size,
depending on plot type and function). Note that bar and bin widths mostly
need smaller values than dot sizes.</p></td>
    </tr>
    <tr>
      <th>show.loess</th>
      <td><p>Logical, if <code>TRUE</code>, an additional loess-smoothed line is plotted.</p></td>
    </tr>
    <tr>
      <th>show.loess.ci</th>
      <td><p>Logical, if <code>TRUE</code>, a confidence region for the loess-smoothed line
will be plotted.</p></td>
    </tr>
    <tr>
      <th>show.p</th>
      <td><p>Logical, if <code>TRUE</code> (default), p-values for polynomial terms are
printed to the console.</p></td>
    </tr>
    <tr>
      <th>show.scatter</th>
      <td><p>Logical, if <code>TRUE</code> (default), adds a scatter plot of
data points to the plot. Only applies for slope-type or predictions plots.
For most plot types, dots are jittered to avoid overplotting, hence the
points don't reflect exact values in the data.</p></td>
    </tr>
    <tr>
      <th>point.alpha</th>
      <td><p>Alpha value of point-geoms in the scatter plots. Only applies,
if <code>show.scatter = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>point.color</th>
      <td><p>Color of of point-geoms in the scatter plots. Only applies,
if <code>show.scatter = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>loess.color</th>
      <td><p>Color of the loess-smoothed line. Only applies, if <code>show.loess = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>prnt.plot</th>
      <td><p>logical, if <code>TRUE</code> (default), plots the results as graph. Use <code>FALSE</code> if you don't
want to plot any graphs. In either case, the ggplot-object will be returned as value.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>(Insisibily) returns</p><dl class='dl-horizontal'>
           <dt><code>plot</code></dt><dd><p>the ggplot-object with the complete plot</p></dd>
           <dt><code>df</code></dt><dd><p>the data frame that was used for setting up the ggplot-object</p></dd>
           <dt><code>cutpoints</code></dt><dd><p>a data frame that indicates x-values and predicted y-values of each direction change in the loess curvature</p></dd>
          </dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For each polynomial degree, a simple linear regression on <code>x</code> (resp.
           the extracted response, if <code>x</code> is a fitted model) is performed,
           where only the polynomial term <code>poly.term</code> is included as independent variable.
           Thus, <code>lm(y ~ x + I(x^2) + ... + I(x^i))</code> is repeatedly computed
           for all values in <code>poly.degree</code>, and the predicted values of
           the reponse are plotted against the raw values of <code>poly.term</code>.
           If <code>x</code> is a fitted model, other covariates are ignored when
           finding the best fitting polynomial. <br /> <br />
           This function evaluates raw polynomials, <em>not orthogonal</em> polynomials.
           Polynomials are computed using the <code>poly</code> function,
           with argument <code>raw = TRUE</code>. <br /> <br />
           To find out which polynomial degree fits best to the data, a loess-smoothed
           line (in dark grey) can be added (with <code>show.loess = TRUE</code>). The polynomial curves
           that comes closest to the loess-smoothed line should be the best
           fit to the data.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>To plot marginal effects of polynomial terms, call <code><a href='sjp.lm.html'>sjp.lm</a></code> with <code>type = "poly"</code>,
           or <code><a href='sjp.lmer.html'>sjp.lmer</a></code> respectively for linear mixed models.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>sjmisc</span>)
<span class='fu'>data</span>(<span class='no'>efc</span>)
<span class='co'># linear fit. loess-smoothed line indicates a more</span>
<span class='co'># or less cubic curve</span>
<span class='fu'>sjp.poly</span>(<span class='no'>efc</span>$<span class='no'>c160age</span>, <span class='no'>efc</span>$<span class='no'>quol_5</span>, <span class='fl'>1</span>)</div><div class='output co'>#&gt; Polynomial degrees: 1
#&gt; ---------------------
#&gt; p(x^1): 0.000
#&gt; </div><div class='img'><img src='sjp.poly-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># quadratic fit</span>
<span class='fu'>sjp.poly</span>(<span class='no'>efc</span>$<span class='no'>c160age</span>, <span class='no'>efc</span>$<span class='no'>quol_5</span>, <span class='fl'>2</span>)</div><div class='output co'>#&gt; Polynomial degrees: 2
#&gt; ---------------------
#&gt; p(x^1): 0.078
#&gt; p(x^2): 0.533
#&gt; </div><div class='img'><img src='sjp.poly-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># linear to cubic fit</span>
<span class='fu'>sjp.poly</span>(<span class='no'>efc</span>$<span class='no'>c160age</span>, <span class='no'>efc</span>$<span class='no'>quol_5</span>, <span class='fl'>1</span>:<span class='fl'>4</span>, <span class='kw'>show.scatter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; Polynomial degrees: 1
#&gt; ---------------------
#&gt; p(x^1): 0.000
#&gt; 
#&gt; Polynomial degrees: 2
#&gt; ---------------------
#&gt; p(x^1): 0.078
#&gt; p(x^2): 0.533
#&gt; 
#&gt; Polynomial degrees: 3
#&gt; ---------------------
#&gt; p(x^1): 0.012
#&gt; p(x^2): 0.001
#&gt; p(x^3): 0.000
#&gt; 
#&gt; Polynomial degrees: 4
#&gt; ---------------------
#&gt; p(x^1): 0.777
#&gt; p(x^2): 0.913
#&gt; p(x^3): 0.505
#&gt; p(x^4): 0.254
#&gt; </div><div class='img'><img src='sjp.poly-3.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># fit sample model</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>lm</span>(<span class='no'>tot_sc_e</span> ~ <span class='no'>c12hour</span> + <span class='no'>e17age</span> + <span class='no'>e42dep</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>efc</span>)
<span class='co'># inspect relationship between predictors and response</span>
<span class='fu'><a href='plot_model.html'>plot_model</a></span>(<span class='no'>fit</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"slope"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at 4.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 2.015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  2.8666e-015</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1</span></div><div class='img'><img src='sjp.poly-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># "e17age" does not seem to be linear correlated to response</span>
<span class='co'># try to find appropiate polynomial. Grey line (loess smoothed)</span>
<span class='co'># indicates best fit. Looks like x^4 has the best fit,</span>
<span class='co'># however, only x^3 has significant p-values.</span>
<span class='fu'>sjp.poly</span>(<span class='no'>fit</span>, <span class='st'>"e17age"</span>, <span class='fl'>2</span>:<span class='fl'>4</span>, <span class='kw'>show.scatter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; Polynomial degrees: 2
#&gt; ---------------------
#&gt; p(x^1): 0.734
#&gt; p(x^2): 0.721
#&gt; 
#&gt; Polynomial degrees: 3
#&gt; ---------------------
#&gt; p(x^1): 0.010
#&gt; p(x^2): 0.011
#&gt; p(x^3): 0.011
#&gt; 
#&gt; Polynomial degrees: 4
#&gt; ---------------------
#&gt; p(x^1): 0.234
#&gt; p(x^2): 0.267
#&gt; p(x^3): 0.303
#&gt; p(x^4): 0.343
#&gt; </div><div class='img'><img src='sjp.poly-5.png' alt='' width='700' height='433' /></div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># fit new model</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>lm</span>(<span class='no'>tot_sc_e</span> ~ <span class='no'>c12hour</span> + <span class='no'>e42dep</span> + <span class='no'>e17age</span> + <span class='fu'>I</span>(<span class='no'>e17age</span>^<span class='fl'>2</span>) + <span class='fu'>I</span>(<span class='no'>e17age</span>^<span class='fl'>3</span>),
          <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>efc</span>)
<span class='co'># plot marginal effects of polynomial term</span>
<span class='fu'><a href='plot_model.html'>plot_model</a></span>(<span class='no'>fit</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"pred"</span>, <span class='kw'>terms</span> <span class='kw'>=</span> <span class='st'>"e17age"</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Daniel Lüdecke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

